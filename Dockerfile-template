##########################################
# This is for testing and demo purposes. #
##########################################
FROM ${PYTHON_IMAGE}

WORKDIR /app

COPY ./scripts ./scripts
RUN ls -r
RUN ./scripts/setup-e2e-tests-for-linux.sh

# Install uv and project dependencies
RUN curl -LsSf https://astral.sh/uv/install.sh | sh
ENV PATH="/root/.cargo/bin:$PATH"

# Copy project files needed for uv
COPY ./pyproject.toml ./uv.lock ./
RUN uv sync --frozen

COPY ./dnastack ./dnastack
#COPY ./samples ./samples
COPY ./tests ./tests

CMD bash -c "./scripts/run-e2e-tests.sh -fv tests/cli/test_* tests/client/test_*"
