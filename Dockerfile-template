##########################################
# This is for testing and demo purposes. #
##########################################
FROM ${PYTHON_IMAGE}

WORKDIR /app

COPY ./scripts ./scripts
RUN ls -r
RUN ./scripts/setup-e2e-tests-for-linux.sh

# Ensure uv is in PATH for subsequent commands
ENV PATH="/root/.local/bin:$PATH"

# Copy project files needed for uv
COPY ./pyproject.toml ./uv.lock ./
RUN uv sync --frozen

COPY ./dnastack ./dnastack
#COPY ./samples ./samples
COPY ./tests ./tests
COPY ./Makefile ./Makefile

CMD bash -c "./scripts/run-e2e-tests.sh -fv tests/cli/test_* tests/client/test_*"
